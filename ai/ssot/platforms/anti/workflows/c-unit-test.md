---
description: 为 C 代码设计单元测试
---

# C Unit Test Workflow

来源 Skill: `.trae/skills/c-unit-test/SKILL.md`

## 使用场景

- 为 C 库编写测试
- 嵌入式代码测试
- 算法验证
- 回归测试
- 持续集成

## 执行步骤

1. **选择测试框架**
   - CMocka（推荐）
   - Unity
   - Check

2. **设计测试用例**
   - 正向测试
   - 边界条件测试
   - 异常处理测试
   - 空指针测试

3. **编写测试代码**
   - 创建测试文件
   - 实现 setup/teardown
   - 编写断言

4. **配置覆盖率**
   - 使用 gcov
   - 设置编译标志

5. **执行并验证**
   - 运行所有测试
   - 检查覆盖率报告
   - 使用 Valgrind 检测内存泄漏

## 最佳实践

1. **隔离测试**: 每个测试独立运行
2. **内存检查**: 使用 Valgrind 检测泄漏
3. **边界测试**: 特别关注边界条件
4. **Mock 外部**: 模拟硬件和外部依赖
