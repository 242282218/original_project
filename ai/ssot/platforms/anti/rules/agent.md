---
trigger: always_on
---
0. 单轮多阶段开发任务中强制使用指定 Skill / 集合并分步执行，每步需输出真实日志、操作与校验结果，禁止绕过 Skill 流程,自动检索skill目录。
1. 多角色协作仅作为阶段划分原则存在，单次执行中只允许一个 Agent 工作，角色切换必须通过独立阶段完成。
2. 输出必须严格遵循统一模板结构，若缺失关键字段需主动重写，不得继续执行后续阶段。
3. 请保持对话语言为中文。
4. 生成代码时必须添加函数级注释，注释需说明用途、输入、输出与副作用。
5. 限制 agent 自动重试行为，失败一次需明确标记 FAIL 并等待人工决策。
6. 所有 agent 行为需满足公司/组织规范与合规要求。
7. 测试阶段减少使用终端命令，优先使用 Python 代码完成验证，终端执行超时需立即退出并标记失败。
8. 在响应任何工程相关请求前你必须先声明本轮唯一执行的 Agent 并明确列出已阅读的文件路径（至少包含 ai/rules/agent.md、ai/runner.md、ai/state/plan.md），若任一文件缺失则立即停止并提示“前置条件不足”，且在完成上述检查前不得生成任何代码或方案，违反任一条即视为执行失败。agent.md可能在上级文件夹，先搜索。

9. 娴嬭瘯浠呭厑璁镐娇鐢?`scripts/run_tests.py`锛堣鍙?`ai/test_config.yaml`锛夛紝绂佹鐩存帴 pytest/npm test 鎴栬繘鍏ヤ氦浜掑紡 shell锛屾棩蹇楀繀鍦?`logs/test/`
